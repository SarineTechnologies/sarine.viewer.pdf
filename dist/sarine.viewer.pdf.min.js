/*!
sarine.viewer.pdf - v0.14.7 -  Thursday, January 18th, 2018, 3:13:42 PM 
 The source code, name, and look and feel of the software are Copyright Â© 2015 Sarine Technologies Ltd. All Rights Reserved. You may not duplicate, copy, reuse, sell or otherwise exploit any portion of the code, content or visual design elements without express written permission from Sarine Technologies Ltd. The terms and conditions of the sarine.com website (http://sarine.com/terms-and-conditions/) apply to the access and use of this software.
 */
(function(){var a,b=function(a,b){return function(){return a.apply(b,arguments)}},c={}.hasOwnProperty,d=function(a,b){function d(){this.constructor=a}for(var e in b)c.call(b,e)&&(a[e]=b[e]);return d.prototype=b.prototype,a.prototype=new d,a.__super__=b.prototype,a};a=function(a){function c(a){this.scaleImage=b(this.scaleImage,this),this.initPopup=b(this.initPopup,this),c.__super__.constructor.call(this,a),this.pdfName=a.pdfName,this.limitSize=a.limitSize,this.mode=a.mode,this.limitSize=this.limitSize||250,this.baseUrl=a.baseUrl+"atomic/v1/assets/"}return d(c,a),c.prototype.convertElement=function(){return this.element},c.prototype.first_init=function(){var a,b,c,d;return b=$.Deferred(),this.fullSrc=this.src,d=this,a=window.configuration.experiences.filter(function(a){return"externalPdf"===a.atom}),c=null,0!==a.length&&(c=a[0]),this.previewSrc=-1===this.fullSrc.indexOf("?")?this.fullSrc+".png":this.fullSrc.split("?")[0]+".png?"+this.fullSrc.split("?")[1],this.loadImage(this.previewSrc).then(function(a){var e,f,g,h;return e=$("<canvas>"),h=a.src===d.callbackPic||-1!==a.src.indexOf("data:image")?"PDF-thumb no_stone":"PDF-thumb",f=e[0].getContext("2d"),g=d.scaleImage(a),e.attr({width:g.width,height:g.height,class:h}),f.drawImage(a,0,0,g.width,g.height),d.element.append(e),e.hasClass("no_stone")||(c&&c.mode&&"popup"===c.mode||"popup"===d.element.data("mode")?e.on("click",function(a){return function(a){return d.initPopup(d.fullSrc)}}()):e.on("click",function(a){return function(a){return window.open(d.fullSrc,"_blank")}}()),e.attr({style:"cursor:pointer;"})),b.resolve(d)})},c.prototype.initPopup=function(a){var b,c,d,e,f,g,h,i,j,k,l,m;return m=this,l=$("body").children().first(),h=$("#iframe-pdf-container"),c=$("#iframe-pdf"),b=$("#closePdfIframe"),0===h.length&&(h=$('<div id="iframe-pdf-container" class="pdf-popup-container">'),i=$('<div class="iframe-pdf-inside-container ">'),j=$('<div class="iframe-pdf-div" style="display:none">'),Device.isMobileOrTablet()&&i.addClass("mobile"),m.inIframe()&&h.addClass("iframe-pdf-container-hide"),k='<svg class="icon icon-angle-left"><path d="M15.429 9v1.286c0 0.683-0.452 1.286-1.175 1.286h-7.071l2.943 2.953c0.241 0.231 0.382 0.563 0.382 0.904s-0.141 0.673-0.382 0.904l-0.753 0.763c-0.231 0.231-0.563 0.372-0.904 0.372s-0.673-0.141-0.914-0.372l-6.539-6.549c-0.231-0.231-0.372-0.563-0.372-0.904s0.141-0.673 0.372-0.914l6.539-6.529c0.241-0.241 0.573-0.382 0.914-0.382s0.663 0.141 0.904 0.382l0.753 0.743c0.241 0.241 0.382 0.573 0.382 0.914s-0.141 0.673-0.382 0.914l-2.943 2.943h7.071c0.723 0 1.175 0.603 1.175 1.286z"></path></svg>',e='<svg class="icon icon-angle-right"><path d="M14.786 9.643c0 0.342-0.131 0.673-0.372 0.914l-6.539 6.539c-0.241 0.231-0.573 0.372-0.914 0.372s-0.663-0.141-0.904-0.372l-0.753-0.753c-0.241-0.241-0.382-0.573-0.382-0.914s0.141-0.673 0.382-0.914l2.943-2.943h-7.071c-0.723 0-1.175-0.603-1.175-1.286v-1.286c0-0.683 0.452-1.286 1.175-1.286h7.071l-2.943-2.953c-0.241-0.231-0.382-0.563-0.382-0.904s0.141-0.673 0.382-0.904l0.753-0.753c0.241-0.241 0.563-0.382 0.904-0.382s0.673 0.141 0.914 0.382l6.539 6.539c0.241 0.231 0.372 0.563 0.372 0.904z"></path></svg>',g='<div id="pdf-pager">  <button id="prev">'+k+'</button>  <button id="next">'+e+"</button></div>",c=$('<div id="iframe-pdf"><canvas id="the-canvas"></canvas></div>'),b=$('<input type="button" value="Close" id="closePdfReport" class="close-popup-report"/>'),f=$('<div class="open-pdf-link-container"><a href="'+a+'" target="_blank" id="open-pdf-link"  ><svg class="icon icon-external-link"> <title>external-link</title> <path d="M14.143 9.321v3.214c0 1.597-1.296 2.893-2.893 2.893h-8.357c-1.597 0-2.893-1.296-2.893-2.893v-8.357c0-1.597 1.296-2.893 2.893-2.893h7.071c0.181 0 0.321 0.141 0.321 0.321v0.643c0 0.181-0.141 0.321-0.321 0.321h-7.071c-0.884 0-1.607 0.723-1.607 1.607v8.357c0 0.884 0.723 1.607 1.607 1.607h8.357c0.884 0 1.607-0.723 1.607-1.607v-3.214c0-0.181 0.141-0.321 0.321-0.321h0.643c0.181 0 0.321 0.141 0.321 0.321zM18 0.643v5.143c0 0.352-0.291 0.643-0.643 0.643-0.171 0-0.331-0.070-0.452-0.191l-1.768-1.768-6.549 6.549c-0.060 0.060-0.151 0.1-0.231 0.1s-0.171-0.040-0.231-0.1l-1.145-1.145c-0.060-0.060-0.1-0.151-0.1-0.231s0.040-0.171 0.1-0.231l6.549-6.549-1.768-1.768c-0.121-0.121-0.191-0.281-0.191-0.452 0-0.352 0.291-0.643 0.643-0.643h5.143c0.352 0 0.643 0.291 0.643 0.643z"></path> </svg></a></div>'),d='<div class="loader popup-loader"><div class="pre-load"></div></div>',j.append(f),f.append(g),j.append(c),j.append(b),i.append(j),i.append(d),h.append(i),l.before(h),m.render_pdf(a)),h.css("display","block"),b.on("click",function(a){return function(){h.css("display","none")}}())},c.prototype.inIframe=function(){try{return window.self!==window.top}catch(a){return a,!0}},c.prototype.scaleImage=function(a){var b,c,d;return b={},b.width=a.width,b.height=a.height,a.width<this.limitSize||a.height<this.limitSize?b:(d=a.width>a.height,d?(c=a.width/this.limitSize,b.width=this.limitSize,b.height=a.height/c):(c=a.height/this.limitSize,b.height=this.limitSize,b.width=a.width/c),b)},c.prototype.full_init=function(){var a;return a=$.Deferred(),a.resolve(this),a},c.prototype.play=function(){},c.prototype.stop=function(){},c.prototype.onPrevPage=function(){var a;if(a=this,!(a.pageNum<=1))return a.pageNum--,a.pageNum<=1?($("#prev").addClass("icon-disable"),$("#next").removeClass("icon-disable")):$("#prev").removeClass("icon-disable"),a.queueRenderPage(a.pageNum)},c.prototype.onNextPage=function(){var a;if(a=this,!(a.pageNum>=a.pdfDoc.numPages))return a.pageNum++,a.pageNum>=a.pdfDoc.numPages?($("#next").addClass("icon-disable"),$("#prev").removeClass("icon-disable")):$("#next").removeClass("icon-disable"),a.queueRenderPage(a.pageNum)},c.prototype.render_pdf=function(a){var b,c;return c=this,c.pdfDoc=null,c.pageNum=1,c.pageRendering=!1,c.pageNumPending=null,c.scale=.8,c.canvas=document.getElementById("the-canvas"),c.ctx=c.canvas.getContext("2d"),b=[{element:"script",src:"//mozilla.github.io/pdf.js/build/pdf.js"}],c.loadAssets(b,function(){return PDFJS.workerSrc="//mozilla.github.io/pdf.js/build/pdf.worker.js",PDFJS.getDocument(a).then(function(a){return c.pdfDoc=a,c.pdfDoc.numPages>1?(document.getElementById("prev").addEventListener("click",c.onPrevPage.bind(c)),document.getElementById("next").addEventListener("click",c.onNextPage.bind(c))):$("#pdf-pager").css("display","none"),$("#prev").addClass("icon-disable"),c.renderPage(c.pageNum)})})},c.prototype.renderPage=function(a){var b;return b=this,b.pageRendering=!0,b.pdfDoc.getPage(a).then(function(a){var c,d,e,f,g,h;return h=a.getViewport(1),c=document.getElementsByClassName("iframe-pdf-inside-container")[0].offsetWidth,f=c/h.width,g=a.getViewport(f),b.canvas.height=g.height,b.canvas.width=g.width,d={canvasContext:b.ctx,viewport:g},$(".popup-loader").css("display","block"),e=a.render(d),e.promise.then(function(){if(b.pageRendering=!1,$(".iframe-pdf-div").css("display","block"),$(".popup-loader").css("display","none"),null!==b.pageNumPending)return b.renderPage(b.pageNumPending),b.pageNumPending=null})})},c.prototype.queueRenderPage=function(a){var b;return b=this,b.pageRendering?b.pageNumPending=a:b.renderPage(a)},c}(Viewer),this.PDF=a}).call(this);